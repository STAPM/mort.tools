<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mortality forecasting • mort.tools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mortality forecasting">
<meta property="og:description" content="mort.tools">
<meta property="og:image" content="https://stapm.gitlab.io/r-packages/mort.tools/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-167990045-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167990045-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mort.tools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mort-tools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Technical documentation</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://gitlab.com/stapm/r-packages/mort.tools">
    <span class="fab fa-gitlab fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://stapm.gitlab.io/software.html">
    <span class="fas fa-code"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mortality_forecasting_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mortality forecasting</h1>
            
      
      
      <div class="hidden name"><code>mortality_forecasting.Rmd</code></div>

    </div>

    
    
<div id="smoothed-and-forecast-mortality-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#smoothed-and-forecast-mortality-rates" class="anchor"></a>Smoothed and forecast mortality rates</h2>
<p>STAPM operates on the basis of projecting the past trends in the age-patterns of cause-specific mortality forwards into the future for each sex and Index of Multiple deprivation population subgroup. It is important to also consider how mortality might change into the future due to factors that are not related to smoking. For example, the effect of a future policy on cardiovascular disease mortality might be over-estimated if the ongoing declines in cardiovascular mortality rates are not modelled <span class="citation">(<a href="#ref-castillo2014future" role="doc-biblioref">Castillo et al. 2014</a>)</span>. For STPM, this presents the challenge of producing forecasts of the age-patterns of cause-specific mortality for each sex and Index of Multiple Deprivation population subgroup. Intervention effects would then be modelled as adjustments to these trends.</p>
<p>The advantages of conducting a cause-specific forecast is that it enables us to incorporate different trends for different diseases and different subgroups e.g. that that there are fewer deaths from Ischeamic Heart disease but more from dementia, and that lung cancer rates are declining in males but rising in females. Cause-specific forecasts stratified by IMD quintiles also allow us to incorporate the different socioeconomic trends in past mortality and to project an expectation of the future socioeconomic trends in mortality.</p>
<p>There are several methods that might be used <span class="citation">(<a href="#ref-Li2019" role="doc-biblioref">Li et al. 2019</a>; <a href="#ref-Arnold2013" role="doc-biblioref">Arnold and Sherris 2013</a>; <a href="#ref-Bergeron-Boucher2017" role="doc-biblioref">Bergeron-Boucher et al. 2017</a>)</span>. An issue with cause-specific mortality forecasting is that the forecasts of cause-specific mortality rates generally do not add up to the forecasts of the aggregate all-cause mortality rates. Wilmoth <span class="citation">(<a href="#ref-Wilmoth1995" role="doc-biblioref">1995</a>)</span> observed that mortality projections are more pessimistic when disaggregated by cause of death because the causes of death that are decreasing the most slowly or that are increasing come to dominate (i.e. the aggegate trends are most influenced by trends in the causes with the most deaths).</p>
<div id="lee-carter-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#lee-carter-methods" class="anchor"></a>Lee-Carter methods</h3>
<p>Our current approach in STAPM is to conduct a Lee-Carter forecast <span class="citation">(<a href="#ref-Lee1992" role="doc-biblioref">Lee and Carter 1992</a>)</span> separately for mortality from different causes within 10 subgroups defined by combinations of sex and IMD quintile. The Lee-carter method is a “proportional rate of change model.” It summarises the age-period surface of log-mortality rates (<span class="math inline">\(\log{}m_{xt}\)</span>) in terms of vectors <span class="math inline">\(\mathbf{a}\)</span> and <span class="math inline">\(\mathbf{b}\)</span> along the age dimension and <span class="math inline">\(\mathbf{k}\)</span> along the time dimension such that</p>
<p><span class="math display">\[\begin{equation}
\log{}m_{xt}=a_x+b_xk_t+e_{xt}  \label{leecartereq}
\end{equation}\]</span></p>
<p>with restrictions such that the <span class="math inline">\(b\)</span>’s are normalized to sum to one and the <span class="math inline">\(k\)</span>’s sum to zero, so the <span class="math inline">\(a\)</span>’s are average log rates.</p>
<p>The vector <span class="math inline">\(\mathbf{a}\)</span> can be interpreted as an average age profile of mortality, the vector <span class="math inline">\(\mathbf{k}\)</span> tracks mortality changes over time, and the vector <span class="math inline">\(\mathbf{b}\)</span> determines how much each age group changes when <span class="math inline">\(k_t\)</span> changes. When <span class="math inline">\(k_t\)</span> is linear on time each age group changes at its own exponential rate, but this is not a requirement of the model. The error term reflects age-period effects not captured by the model.</p>
<p>The vector <span class="math inline">\(\mathbf{a}\)</span> is estimated by averaging log rates over time and <span class="math inline">\(\mathbf{b}\)</span> and <span class="math inline">\(\mathbf{k}\)</span> via a singular value decomposition (SVD) of the residuals (this is essentially a method for approximating a matrix as the product of two vectors).</p>
<p>Having reduced the time dimension of mortality to a single vector <span class="math inline">\(\mathbf{k}\)</span>, this is then projected forward by an ARIMA time series model. In our forecasting for STAPM we don’t currently incorporate forecast error but if we were to then it would be based on the error in this time series model.</p>
<p>Future mortality is then estimated by inputting the extrapolated values of <span class="math inline">\(k_t\)</span> back into ().</p>
</div>
<div id="our-application-of-these-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#our-application-of-these-methods" class="anchor"></a>Our application of these methods</h3>
<p>Before we conduct our cause and subgroup specific mortality forecast, we reduce the noise in the matrix of observed rates of mortality by smoothing each matrix over age and period. To do so, we estimate a moving average based on the application of a two-dimensional sliding window (we adjust the degree of smoothing by adjusting the size of the window). We find that smoothing is particularly important for the rarer causes, as the projected future trends for these causes can be strongly influenced by noise in the observed rates.</p>
<p>We conduct the forecast using the R package <code>demography</code> <span class="citation">(<a href="#ref-RJHHBLTJ2019" role="doc-biblioref">Rob J Hyndman with contributions from Heather Booth and Leonie Tickle and John Maindonald. 2019</a>)</span>. We conduct a set of cause-specific forecasts and also a forecast of the remaining other-cause mortality. In our <code>mort.tools</code> R package, the forecast is conducted by the function <code><a href="../reference/CombinedForecast.html">CombinedForecast()</a></code>, which is a wrapper that calls the function <code><a href="../reference/MortalityForecast.html">MortalityForecast()</a></code> to run the forecast for each cause and groups the outputs together. The forecast is run for 10 population subgroups defined by combinations of sex and IMD quintile.</p>
<p>The parameters that control the forecast for each cause are contained in a separate spreadsheet, which is input into <code><a href="../reference/CombinedForecast.html">CombinedForecast()</a></code> as <code>forecast_params</code> (Figure 3). The parameters in this spreadsheet allow the control of the period and and age range that are used to inform the forecast for each cause, and the degree of smoothing to apply to the past trends in mortality.</p>
<p><img src="forecast_spreadsheet_snapshot.png" width="800"></p>
<p>Given all the potential unreliabilities of a cause-specific forecast, it is important to consider how far in the future the trends in mortality might be extrapolated reliably. Once this final year is determined, if we want the STAPM projections to run beyond it, we assume that the mortality rates in the control arm of our model will remain constant into the future from this final year.</p>
<p>There is lots of room for improvement in this forecasting method, particularly looking into incorporating forecast undertainty, and developing methods that improve the consistency between the forecasts of cause-specific mortality and those of all-cause mortality <span class="citation">(<a href="#ref-Li2019" role="doc-biblioref">Li et al. 2019</a>; <a href="#ref-Arnold2013" role="doc-biblioref">Arnold and Sherris 2013</a>; <a href="#ref-Bergeron-Boucher2017" role="doc-biblioref">Bergeron-Boucher et al. 2017</a>)</span>.</p>
</div>
<div id="example-forecast" class="section level3">
<h3 class="hasAnchor">
<a href="#example-forecast" class="anchor"></a>Example forecast</h3>
<p>The following code provides the observed and forecast cause and subgroup specific mortality rates for use in STAPM. In this case, we forecast the trends from 2016 to 2100. In Figure 4, we select the forecast values for lung cancer in males and compare the forecast trends between the least and most deprived IMD quintiles.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#install.packages("X:/ScHARR/PR_STAPM/Code/R_packages/mort.tools_1.0.0.zip", </span>
  <span class="co"># repos = NULL, type = "binary")</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stapm.gitlab.io/r-packages/mort.tools">mort.tools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span>

<span class="co"># The observed mortality rates to input into the smoothing and forecasting process</span>
<span class="va">mort_data_cause</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="st">"X:/ScHARR/PR_Mortality_data_TA/Code/model_inputs/Output/
                         tob_death_rates_national_2019-05-06_mort.tools_1.0.0.csv"</span><span class="op">)</span>

<span class="co"># The paramaters that control the smoothing and forecast methods for each cause</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="st">"data-raw/Mortality data/
                          tobacco mortality forecasting parameters.xlsx"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Run the forecast</span>
<span class="va">cforecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CombinedForecast.html">CombinedForecast</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">mort_data_cause</span>,
  forecast_params <span class="op">=</span> <span class="va">params</span>,
  n_years <span class="op">=</span> <span class="fl">2100</span> <span class="op">-</span> <span class="fl">2016</span>, <span class="co"># time horizon - jumpoff year</span>
  folder_path <span class="op">=</span> <span class="st">"data-raw/Mortality data"</span>
<span class="op">)</span>

<span class="va">tob_mort_data_cause</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span><span class="op">(</span><span class="va">cforecast</span><span class="op">$</span><span class="va">mx_data_cause</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Arnold2013" class="csl-entry">
Arnold, Séverine, and Michael Sherris. 2013. <span>“Forecasting Mortality Trends Allowing for Cause-of-Death Mortality Dependence.”</span> Journal Article. <em>North American Actuarial Journal</em> 17 (4): 273–82. <a href="https://doi.org/10.1080/10920277.2013.838141">https://doi.org/10.1080/10920277.2013.838141</a>.
</div>
<div id="ref-Bergeron-Boucher2017" class="csl-entry">
Bergeron-Boucher, Marie-Pier, Vladimir Canudas-Romo, Jim Oeppen, and James W. Vaupel. 2017. <span>“Coherent Forecasts of Mortality with Compositional Data Analysis.”</span> Journal Article. <em>Demographic Research</em> 37: 527–66. <a href="https://doi.org/10.4054/DemRes.2017.37.17">https://doi.org/10.4054/DemRes.2017.37.17</a>.
</div>
<div id="ref-castillo2014future" class="csl-entry">
Castillo, Maria Guzman, Duncan OS Gillespie, Kirk Allen, Piotr Bandosz, Volker Schmid, Simon Capewell, and Martin O’Flaherty. 2014. <span>“Future Declines of Coronary Heart Disease Mortality in England and Wales Could Counter the Burden of Population Ageing.”</span> <em>PLoS One</em> 9 (6): e99482.
</div>
<div id="ref-Lee1992" class="csl-entry">
Lee, Ronald D, and Lawrence R Carter. 1992. <span>“Modeling and Forecasting US Mortality.”</span> Journal Article. <em>Journal of the American Statistical Association</em> 87 (419): 659–71.
</div>
<div id="ref-Li2019" class="csl-entry">
Li, Han, Hong Li, Yang Lu, and Anastasios Panagiotelis. 2019. <span>“A Forecast Reconciliation Approach to Cause-of-Death Mortality Modeling.”</span> Journal Article. <em>Insurance: Mathematics and Economics</em> 86: 122–33. <a href="https://doi.org/10.1016/j.insmatheco.2019.02.011">https://doi.org/10.1016/j.insmatheco.2019.02.011</a>.
</div>
<div id="ref-RJHHBLTJ2019" class="csl-entry">
Rob J Hyndman with contributions from Heather Booth and Leonie Tickle and John Maindonald. 2019. <em><span class="nocase">demography: Forecasting Mortality, Fertility, Migration and Population Data</span></em>. <a href="%7Bhttps://CRAN.R-project.org/package=demography%7D">{https://CRAN.R-project.org/package=demography}</a>.
</div>
<div id="ref-Wilmoth1995" class="csl-entry">
Wilmoth, J. R. 1995. <span>“Are Mortality Projections Always More Pessimistic When Disaggregated by Cause of Death?”</span> Journal Article. <em>Math Popul Stud</em> 5 (4): 293–319, 377. <a href="https://doi.org/10.1080/08898489509525409">https://doi.org/10.1080/08898489509525409</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.sheffield.ac.uk/scharr/sections/heds/staff/gillespie_d">Duncan Gillespie</a>, Laura Webster, <a href="https://www.sheffield.ac.uk/scharr/sections/heds/staff/angus_c">Colin Angus</a>, <a href="https://www.sheffield.ac.uk/scharr/sections/heds/staff/brennan_a">Alan Brennan</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
